# This file is copied to spec/ when you run 'rails generate rspec:install'
ENV["RAILS_ENV"] ||= 'test'
require 'spec_helper'
require File.expand_path("../../config/environment", __FILE__)
require 'rspec/rails'
require 'capybara/rails'
require 'webmock/rspec'
require 'hashie'
WebMock.disable_net_connect!(allow_localhost: true)

sample_api_response = {"currently"=>{"apparentTemperature"=>15.79,"cloudCover"=>0.36,"dewPoint"=>14.57,"humidity"=>0.92,"icon"=>"partly-cloudy-night","nearestStormDistance"=>0,"ozone"=>327.23,"precipIntensity"=>0.0838,"precipIntensityError"=>0.0279,"precipProbability"=>0.27,"precipType"=>"rain","pressure"=>1005.21,"summary"=>"Partly Cloudy","temperature"=>15.79,"time"=>1406932835,"visibility"=>10.22,"windBearing"=>170,"windSpeed"=>4.4},"daily"=>{"data"=>[{"apparentTemperatureMax"=>21.11,"apparentTemperatureMaxTime"=>1406898000,"apparentTemperatureMin"=>14.02,"apparentTemperatureMinTime"=>1406869200,"cloudCover"=>0.47,"dewPoint"=>13.72,"humidity"=>0.82,"icon"=>"rain","moonPhase"=>0.17,"ozone"=>332.6,"precipIntensity"=>0.2311,"precipIntensityMax"=>0.5461,"precipIntensityMaxTime"=>1406926800,"precipProbability"=>1,"precipType"=>"rain","pressure"=>1007.43,"summary"=>"Light rain starting in the afternoon.","sunriseTime"=>1406867117,"sunsetTime"=>1406923312,"temperatureMax"=>21.11,"temperatureMaxTime"=>1406898000,"temperatureMin"=>14.02,"temperatureMinTime"=>1406869200,"time"=>1406847600,"visibility"=>9.45,"windBearing"=>197,"windSpeed"=>6.34}, {"apparentTemperatureMax"=>19.92,"apparentTemperatureMaxTime"=>1406998800,"apparentTemperatureMin"=>15.1,"apparentTemperatureMinTime"=>1406955600,"cloudCover"=>0.54,"dewPoint"=>14.53,"humidity"=>0.85,"icon"=>"rain","moonPhase"=>0.2,"ozone"=>342.31,"precipIntensity"=>0.3632,"precipIntensityMax"=>0.8763,"precipIntensityMaxTime"=>1406991600,"precipProbability"=>1,"precipType"=>"rain","pressure"=>1002.02,"summary"=>"Light rain throughout the day.","sunriseTime"=>1406953614,"sunsetTime"=>1407009609,"temperatureMax"=>19.92,"temperatureMaxTime"=>1406998800,"temperatureMin"=>15.1,"temperatureMinTime"=>1406955600,"time"=>1406934000,"visibility"=>14.98,"windBearing"=>162,"windSpeed"=>6.53},{"apparentTemperatureMax"=>21.11,"apparentTemperatureMaxTime"=>1407081600,"apparentTemperatureMin"=>12.21,"apparentTemperatureMinTime"=>1407042000,"cloudCover"=>0.2,"dewPoint"=>10.77,"humidity"=>0.7,"icon"=>"partly-cloudy-day","moonPhase"=>0.24,"ozone"=>350.67,"precipIntensity"=>0.0305,"precipIntensityMax"=>0.0914,"precipIntensityMaxTime"=>1407020400,"precipProbability"=>0.04,"precipType"=>"rain","pressure"=>1006.15,"summary"=>"Partly cloudy in the morning.","sunriseTime"=>1407040112,"sunsetTime"=>1407095904,"temperatureMax"=>21.11,"temperatureMaxTime"=>1407081600,"temperatureMin"=>12.21,"temperatureMinTime"=>1407042000,"time"=>1407020400,"visibility"=>16.09,"windBearing"=>237,"windSpeed"=>10.92},{"apparentTemperatureMax"=>21.71,"apparentTemperatureMaxTime"=>1407168000,"apparentTemperatureMin"=>11.18,"apparentTemperatureMinTime"=>1407128400,"cloudCover"=>0.17,"dewPoint"=>11.44,"humidity"=>0.73,"icon"=>"rain","moonPhase"=>0.27,"ozone"=>344.01,"precipIntensity"=>0.066,"precipIntensityMax"=>0.254,"precipIntensityMaxTime"=>1407175200,"precipProbability"=>0.49,"precipType"=>"rain","pressure"=>1014.18,"summary"=>"Light rain starting in the afternoon, continuing until evening.","sunriseTime"=>1407126610,"sunsetTime"=>1407182197,"temperatureMax"=>21.71,"temperatureMaxTime"=>1407168000,"temperatureMin"=>11.18,"temperatureMinTime"=>1407128400,"time"=>1407106800,"visibility"=>16.09,"windBearing"=>228,"windSpeed"=>3.14},{"apparentTemperatureMax"=>22.09,"apparentTemperatureMaxTime"=>1407254400,"apparentTemperatureMin"=>11.36,"apparentTemperatureMinTime"=>1407207600,"cloudCover"=>0.27,"dewPoint"=>12.66,"humidity"=>0.76,"icon"=>"rain","moonPhase"=>0.3,"ozone"=>337.33,"precipIntensity"=>0.0838,"precipIntensityMax"=>0.127,"precipIntensityMaxTime"=>1407247200,"precipProbability"=>0.23,"precipType"=>"rain","pressure"=>1016.81,"summary"=>"Drizzle in the afternoon.","sunriseTime"=>1407213109,"sunsetTime"=>1407268488,"temperatureMax"=>22.09,"temperatureMaxTime"=>1407254400,"temperatureMin"=>11.36,"temperatureMinTime"=>1407207600,"time"=>1407193200,"visibility"=>16.09,"windBearing"=>169,"windSpeed"=>3.67},{"apparentTemperatureMax"=>20.28,"apparentTemperatureMaxTime"=>1407348000,"apparentTemperatureMin"=>15.07,"apparentTemperatureMinTime"=>1407301200,"cloudCover"=>0.85,"dewPoint"=>15.22,"humidity"=>0.84,"icon"=>"rain","moonPhase"=>0.34,"ozone"=>316.07,"precipIntensity"=>0.2515,"precipIntensityMax"=>0.7366,"precipIntensityMaxTime"=>1407355200,"precipProbability"=>0.82,"precipType"=>"rain","pressure"=>1015.04,"summary"=>"Light rain starting in the afternoon.","sunriseTime"=>1407299608,"sunsetTime"=>1407354778,"temperatureMax"=>20.28,"temperatureMaxTime"=>1407348000,"temperatureMin"=>15.07,"temperatureMinTime"=>1407301200,"time"=>1407279600,"visibility"=>15,"windBearing"=>192,"windSpeed"=>7.07},{"apparentTemperatureMax"=>23.4,"apparentTemperatureMaxTime"=>1407427200,"apparentTemperatureMin"=>16.54,"apparentTemperatureMinTime"=>1407387600,"cloudCover"=>0.76,"dewPoint"=>16.43,"humidity"=>0.82,"icon"=>"rain","moonPhase"=>0.38,"ozone"=>308.54,"precipIntensity"=>0.1372,"precipIntensityMax"=>0.5131,"precipIntensityMaxTime"=>1407366000,"precipProbability"=>0.69,"precipType"=>"rain","pressure"=>1013.72,"summary"=>"Drizzle starting in the afternoon.","sunriseTime"=>1407386108,"sunsetTime"=>1407441066,"temperatureMax"=>23.4,"temperatureMaxTime"=>1407427200,"temperatureMin"=>16.54,"temperatureMinTime"=>1407387600,"time"=>1407366000,"windBearing"=>212,"windSpeed"=>5.83},{"apparentTemperatureMax"=>25.46,"apparentTemperatureMaxTime"=>1407510000,"apparentTemperatureMin"=>16.1,"apparentTemperatureMinTime"=>1407474000,"cloudCover"=>0.13,"dewPoint"=>16.58,"humidity"=>0.79,"icon"=>"rain","moonPhase"=>0.41,"ozone"=>302.34,"precipIntensity"=>0.188,"precipIntensityMax"=>0.4115,"precipIntensityMaxTime"=>1407531600,"precipProbability"=>0.86,"precipType"=>"rain","pressure"=>1013.55,"summary"=>"Light rain throughout the day.","sunriseTime"=>1407472608,"sunsetTime"=>1407527352,"temperatureMax"=>25.46,"temperatureMaxTime"=>1407510000,"temperatureMin"=>16.1,"temperatureMinTime"=>1407474000,"time"=>1407452400,"windBearing"=>184,"windSpeed"=>5.58}],"icon"=>"rain","summary"=>"Light rain throughout the week, with temperatures rising to 25Â°C on Friday."},"flags"=>{"darksky-stations"=>["uk_manchester"],"datapoint-stations"=>["uk-310007", "uk-310039", "uk-324071", "uk-350157", "uk-350361", "uk-351028", "uk-351195", "uk-351225", "uk-351317", "uk-351998", "uk-352421", "uk-352601", "uk-352602", "uk-353661", "uk-353780", "uk-353781"],"isd-stations"=>["033300-99999", "033380-99999", "033540-99999", "034185-99999", "035905-99999"],"madis-stations"=>["AS770", "AU757", "C1157", "C4386", "C4584", "C5841", "D1848", "D3696", "D6997", "D8070", "D8458", "E0236", "E3467", "E4202", "E5285", "EGNX"],"sources"=>["metwarn", "isd", "nearest-precip", "madis", "gfs", "datapoint", "fnmoc", "cmc", "darksky"],"units"=>"uk"},"hourly"=>{"data"=>[{"apparentTemperature"=>15.74,"cloudCover"=>0.27,"dewPoint"=>14.51,"humidity"=>0.92,"icon"=>"rain","ozone"=>326.81,"precipIntensity"=>0.5131,"precipProbability"=>0.92,"precipType"=>"rain","pressure"=>1005.28,"summary"=>"Light Rain","temperature"=>15.74,"time"=>1406930400,"visibility"=>9.85,"windBearing"=>174,"windSpeed"=>4.36},{"apparentTemperature"=>15.81,"cloudCover"=>0.41,"dewPoint"=>14.59,"humidity"=>0.92,"icon"=>"rain","ozone"=>327.43,"precipIntensity"=>0.2464,"precipProbability"=>0.93,"precipType"=>"rain","pressure"=>1005.17,"summary"=>"Light Rain","temperature"=>15.81,"time"=>1406934000,"visibility"=>10.4,"windBearing"=>168,"windSpeed"=>4.44},{"apparentTemperature"=>15.86,"cloudCover"=>0.5,"dewPoint"=>14.54,"humidity"=>0.92,"icon"=>"rain","ozone"=>328.2,"precipIntensity"=>0.3734,"precipProbability"=>0.87,"precipType"=>"rain","pressure"=>1005.01,"summary"=>"Light Rain","temperature"=>15.86,"time"=>1406937600,"visibility"=>11.91,"windBearing"=>161,"windSpeed"=>4.58},{"apparentTemperature"=>15.89,"cloudCover"=>0.58,"dewPoint"=>14.57,"humidity"=>0.92,"icon"=>"rain","ozone"=>328.98,"precipIntensity"=>0.2997,"precipProbability"=>0.69,"precipType"=>"rain","pressure"=>1004.8,"summary"=>"Light Rain","temperature"=>15.89,"time"=>1406941200,"visibility"=>13.21,"windBearing"=>160,"windSpeed"=>5.06},{"apparentTemperature"=>15.81,"cloudCover"=>0.63,"dewPoint"=>14.51,"humidity"=>0.92,"icon"=>"rain","ozone"=>329.91,"precipIntensity"=>0.1803,"precipProbability"=>0.32,"precipType"=>"rain","pressure"=>1004.54,"summary"=>"Drizzle","temperature"=>15.81,"time"=>1406944800,"visibility"=>14.56,"windBearing"=>159,"windSpeed"=>5.56},{"apparentTemperature"=>15.64,"cloudCover"=>0.66,"dewPoint"=>14.34,"humidity"=>0.92,"icon"=>"partly-cloudy-night","ozone"=>331.35,"precipIntensity"=>0.0965,"precipProbability"=>0.09,"precipType"=>"rain","pressure"=>1004.21,"summary"=>"Mostly Cloudy","temperature"=>15.64,"time"=>1406948400,"visibility"=>15.85,"windBearing"=>159,"windSpeed"=>6.04},{"apparentTemperature"=>15.24,"cloudCover"=>0.69,"dewPoint"=>13.97,"humidity"=>0.92,"icon"=>"partly-cloudy-night","ozone"=>333.85,"precipIntensity"=>0.0737,"precipProbability"=>0.04,"precipType"=>"rain","pressure"=>1003.79,"summary"=>"Mostly Cloudy","temperature"=>15.24,"time"=>1406952000,"visibility"=>14.45,"windBearing"=>150,"windSpeed"=>5.87},{"apparentTemperature"=>15.1,"cloudCover"=>0.7,"dewPoint"=>13.83,"humidity"=>0.92,"icon"=>"partly-cloudy-day","ozone"=>336.86,"precipIntensity"=>0.0864,"precipProbability"=>0.04,"precipType"=>"rain","pressure"=>1003.33,"summary"=>"Mostly Cloudy","temperature"=>15.1,"time"=>1406955600,"visibility"=>12.52,"windBearing"=>142,"windSpeed"=>5.85},{"apparentTemperature"=>15.11,"cloudCover"=>0.7,"dewPoint"=>13.82,"humidity"=>0.92,"icon"=>"partly-cloudy-day","ozone"=>339.05,"precipIntensity"=>0.1168,"precipProbability"=>0.08,"precipType"=>"rain","pressure"=>1002.92,"summary"=>"Mostly Cloudy","temperature"=>15.11,"time"=>1406959200,"visibility"=>10.57,"windBearing"=>134,"windSpeed"=>6.07},{"apparentTemperature"=>15.26,"cloudCover"=>0.7,"dewPoint"=>13.73,"humidity"=>0.91,"icon"=>"rain","ozone"=>339.61,"precipIntensity"=>0.16,"precipProbability"=>0.23,"precipType"=>"rain","pressure"=>1002.62,"summary"=>"Drizzle","temperature"=>15.26,"time"=>1406962800,"visibility"=>10.35,"windBearing"=>128,"windSpeed"=>6.58},{"apparentTemperature"=>15.61,"cloudCover"=>0.7,"dewPoint"=>13.81,"humidity"=>0.89,"icon"=>"rain","ozone"=>339.36,"precipIntensity"=>0.221,"precipProbability"=>0.57,"precipType"=>"rain","pressure"=>1002.36,"summary"=>"Drizzle","temperature"=>15.61,"time"=>1406966400,"visibility"=>10.12,"windBearing"=>123,"windSpeed"=>7.17},{"apparentTemperature"=>16.18,"cloudCover"=>0.7,"dewPoint"=>14.08,"humidity"=>0.87,"icon"=>"rain","ozone"=>339.4,"precipIntensity"=>0.2769,"precipProbability"=>0.79,"precipType"=>"rain","pressure"=>1002.05,"summary"=>"Light Rain","temperature"=>16.18,"time"=>1406970000,"visibility"=>9.91,"windBearing"=>120,"windSpeed"=>7.76},{"apparentTemperature"=>17.08,"cloudCover"=>0.7,"dewPoint"=>14.4,"humidity"=>0.84,"icon"=>"rain","ozone"=>339.96,"precipIntensity"=>0.2946,"precipProbability"=>0.89,"precipType"=>"rain","pressure"=>1001.64,"summary"=>"Light Rain","temperature"=>17.08,"time"=>1406973600,"visibility"=>10.35,"windBearing"=>125,"windSpeed"=>8.39},{"apparentTemperature"=>18.11,"cloudCover"=>0.7,"dewPoint"=>14.82,"humidity"=>0.81,"icon"=>"rain","ozone"=>340.82,"precipIntensity"=>0.3023,"precipProbability"=>0.92,"precipType"=>"rain","pressure"=>1001.18,"summary"=>"Light Rain","temperature"=>18.11,"time"=>1406977200,"visibility"=>10.8,"windBearing"=>130,"windSpeed"=>8.97},{"apparentTemperature"=>18.9,"cloudCover"=>0.7,"dewPoint"=>15.03,"humidity"=>0.78,"icon"=>"rain","ozone"=>342.37,"precipIntensity"=>0.3556,"precipProbability"=>0.94,"precipType"=>"rain","pressure"=>1000.8,"summary"=>"Light Rain","temperature"=>18.9,"time"=>1406980800,"visibility"=>11.25,"windBearing"=>134,"windSpeed"=>9.35},{"apparentTemperature"=>19.34,"cloudCover"=>0.69,"dewPoint"=>15.46,"humidity"=>0.78,"icon"=>"rain","ozone"=>345.3,"precipIntensity"=>0.5207,"precipProbability"=>0.96,"precipType"=>"rain","pressure"=>1000.51,"summary"=>"Light Rain","temperature"=>19.34,"time"=>1406984400,"visibility"=>12.34,"windBearing"=>145,"windSpeed"=>8.9},{"apparentTemperature"=>19.61,"cloudCover"=>0.68,"dewPoint"=>15.77,"humidity"=>0.79,"icon"=>"rain","ozone"=>348.92,"precipIntensity"=>0.7391,"precipProbability"=>0.97,"precipType"=>"rain","pressure"=>1000.26,"summary"=>"Light Rain","temperature"=>19.61,"time"=>1406988000,"visibility"=>13.44,"windBearing"=>156,"windSpeed"=>8.82},{"apparentTemperature"=>19.77,"cloudCover"=>0.69,"dewPoint"=>15.98,"humidity"=>0.79,"icon"=>"rain","ozone"=>351.62,"precipIntensity"=>0.8763,"precipProbability"=>0.98,"precipType"=>"rain","pressure"=>1000.03,"summary"=>"Light Rain","temperature"=>19.77,"time"=>1406991600,"visibility"=>14.53,"windBearing"=>165,"windSpeed"=>9.14},{"apparentTemperature"=>19.9,"cloudCover"=>0.62,"dewPoint"=>15.9,"humidity"=>0.78,"icon"=>"rain","ozone"=>352.53,"precipIntensity"=>0.8661,"precipProbability"=>1,"precipType"=>"rain","pressure"=>999.8,"summary"=>"Light Rain","temperature"=>19.9,"time"=>1406995200,"visibility"=>16.09,"windBearing"=>177,"windSpeed"=>8.69},{"apparentTemperature"=>19.92,"cloudCover"=>0.56,"dewPoint"=>15.71,"humidity"=>0.77,"icon"=>"rain","ozone"=>352.52,"precipIntensity"=>0.7645,"precipProbability"=>1,"precipType"=>"rain","pressure"=>999.62,"summary"=>"Light Rain","temperature"=>19.92,"time"=>1406998800,"visibility"=>16.09,"windBearing"=>189,"windSpeed"=>8.61},{"apparentTemperature"=>19.66,"cloudCover"=>0.46,"dewPoint"=>15.29,"humidity"=>0.76,"icon"=>"rain","ozone"=>352.55,"precipIntensity"=>0.6452,"precipProbability"=>0.96,"precipType"=>"rain","pressure"=>999.67,"summary"=>"Light Rain","temperature"=>19.66,"time"=>1407002400,"visibility"=>16.09,"windBearing"=>202,"windSpeed"=>8.96},{"apparentTemperature"=>18.92,"cloudCover"=>0.05,"dewPoint"=>14.77,"humidity"=>0.77,"icon"=>"rain","ozone"=>352.9,"precipIntensity"=>0.5105,"precipProbability"=>0.76,"precipType"=>"rain","pressure"=>1000.12,"summary"=>"Light Rain","temperature"=>18.92,"time"=>1407006000,"visibility"=>16.09,"windBearing"=>203,"windSpeed"=>8.93},{"apparentTemperature"=>17.85,"cloudCover"=>0.02,"dewPoint"=>13.98,"humidity"=>0.78,"icon"=>"rain","ozone"=>353.3,"precipIntensity"=>0.3505,
"precipProbability"=>0.49,"precipType"=>"rain","pressure"=>1000.8,"summary"=>"Light Rain","temperature"=>17.85,"time"=>1407009600,"visibility"=>16.09,"windBearing"=>205,"windSpeed"=>8.87},{"apparentTemperature"=>16.8,"cloudCover"=>0,"dewPoint"=>13.19,"humidity"=>0.79,"icon"=>"rain","ozone"=>353.85,"precipIntensity"=>0.2159,"precipProbability"=>0.25,"precipType"=>"rain","pressure"=>1001.39,"summary"=>"Drizzle","temperature"=>16.8,"time"=>1407013200,"visibility"=>16.09,"windBearing"=>207,"windSpeed"=>8.77},{"apparentTemperature"=>15.92,"cloudCover"=>0.02,"dewPoint"=>12.7,"humidity"=>0.81,"icon"=>"rain","ozone"=>354.84,"precipIntensity"=>0.1346,"precipProbability"=>0.09,"precipType"=>"rain","pressure"=>1001.91,"summary"=>"Drizzle","temperature"=>15.92,"time"=>1407016800,"visibility"=>16.09,"windBearing"=>208,"windSpeed"=>9.14},{"apparentTemperature"=>15.14,"cloudCover"=>0.04,"dewPoint"=>12.26,"humidity"=>0.83,"icon"=>"clear-night","ozone"=>355.99,"precipIntensity"=>0.0914,"precipProbability"=>0.04,"precipType"=>"rain","pressure"=>1002.4,"summary"=>"Clear","temperature"=>15.14,"time"=>1407020400,"visibility"=>16.09,"windBearing"=>209,"windSpeed"=>9.53},{"apparentTemperature"=>14.47,"cloudCover"=>0.07,"dewPoint"=>11.87,"humidity"=>0.84,"icon"=>"clear-night","ozone"=>356.57,"precipIntensity"=>0.066,"precipProbability"=>0.02,"precipType"=>"rain","pressure"=>1002.83,"summary"=>"Clear","temperature"=>14.47,"time"=>1407024000,"visibility"=>16.09,"windBearing"=>210,"windSpeed"=>9.92},{"apparentTemperature"=>13.83,"cloudCover"=>0.2,"dewPoint"=>11.44,"humidity"=>0.86,"icon"=>"clear-night","ozone"=>356.06,"precipIntensity"=>0.0457,"precipProbability"=>0.01,"precipType"=>"rain","pressure"=>1003.19,"summary"=>"Clear","temperature"=>13.83,"time"=>1407027600,"visibility"=>16.09,"windBearing"=>215,"windSpeed"=>10.07},{"apparentTemperature"=>13.23,"cloudCover"=>0.33,"dewPoint"=>11.03,"humidity"=>0.87,"icon"=>"partly-cloudy-night","ozone"=>354.99,"precipIntensity"=>0.0381,"precipProbability"=>0.01,"precipType"=>"rain","pressure"=>1003.51,"summary"=>"Partly Cloudy","temperature"=>13.23,"time"=>1407031200,"visibility"=>16.09,"windBearing"=>220,"windSpeed"=>10.43},{"apparentTemperature"=>12.74,"cloudCover"=>0.46,"dewPoint"=>10.71,"humidity"=>0.87,"icon"=>"partly-cloudy-night","ozone"=>354.2,"precipIntensity"=>0.0381,"precipProbability"=>0.01,"precipType"=>"rain","pressure"=>1003.84,"summary"=>"Partly Cloudy","temperature"=>12.74,"time"=>1407034800,"visibility"=>16.09,"windBearing"=>224,"windSpeed"=>10.71},{"apparentTemperature"=>12.38,"cloudCover"=>0.46,"dewPoint"=>10.29,"humidity"=>0.87,"icon"=>"partly-cloudy-night","ozone"=>354.13,"precipIntensity"=>0.0406,"precipProbability"=>0.01,"precipType"=>"rain","pressure"=>1004.19,"summary"=>"Partly Cloudy","temperature"=>12.38,"time"=>1407038400,"visibility"=>16.09,"windBearing"=>223,"windSpeed"=>10.94},{"apparentTemperature"=>12.21,"cloudCover"=>0.46,"dewPoint"=>10.04,"humidity"=>0.87,"icon"=>"partly-cloudy-day","ozone"=>354.35,"precipIntensity"=>0.0406,"precipProbability"=>0.01,"precipType"=>"rain","pressure"=>1004.55,"summary"=>"Partly Cloudy","temperature"=>12.21,"time"=>1407042000,"visibility"=>16.09,"windBearing"=>222,"windSpeed"=>11.26},{"apparentTemperature"=>12.47,"cloudCover"=>0.47,"dewPoint"=>10.12,"humidity"=>0.86,"icon"=>"partly-cloudy-day","ozone"=>354.45,"precipIntensity"=>0.0406,"precipProbability"=>0.01,"precipType"=>"rain","pressure"=>1004.89,"summary"=>"Partly Cloudy","temperature"=>12.47,"time"=>1407045600,"visibility"=>16.09,"windBearing"=>221,"windSpeed"=>11.74},{"apparentTemperature"=>13.38,"cloudCover"=>0.33,"dewPoint"=>10.04,"humidity"=>0.8,"icon"=>"partly-cloudy-day","ozone"=>354.38,"precipIntensity"=>0.0356,"precipProbability"=>0.01,"precipType"=>"rain","pressure"=>1005.21,"summary"=>"Partly Cloudy","temperature"=>13.38,"time"=>1407049200,"visibility"=>16.09,"windBearing"=>227,"windSpeed"=>11.99},{"apparentTemperature"=>14.76,"cloudCover"=>0.2,"dewPoint"=>10.24,"humidity"=>0.74,"icon"=>"clear-day","ozone"=>354.19,"precipIntensity"=>0.033,"precipProbability"=>0.01,"precipType"=>"rain","pressure"=>1005.51,"summary"=>"Clear","temperature"=>14.76,"time"=>1407052800,"visibility"=>16.09,"windBearing"=>234,"windSpeed"=>12.77},{"apparentTemperature"=>16.18,"cloudCover"=>0.06,"dewPoint"=>10.36,"humidity"=>0.68,"icon"=>"clear-day","ozone"=>353.7,"precipIntensity"=>0,"precipProbability"=>0,"pressure"=>1005.77,"summary"=>"Clear","temperature"=>16.18,"time"=>1407056400,"visibility"=>16.09,"windBearing"=>239,"windSpeed"=>13.88},{"apparentTemperature"=>17.47,"cloudCover"=>0.13,"dewPoint"=>10.54,"humidity"=>0.64,"icon"=>"clear-day","ozone"=>352.71,"precipIntensity"=>0,"precipProbability"=>0,"pressure"=>1005.95,"summary"=>"Clear","temperature"=>17.47,"time"=>1407060000,"visibility"=>16.09,"windBearing"=>239,"windSpeed"=>14.28},{"apparentTemperature"=>18.63,"cloudCover"=>0.2,"dewPoint"=>10.56,"humidity"=>0.59,"icon"=>"clear-day","ozone"=>351.42,"precipIntensity"=>0,"precipProbability"=>0,"pressure"=>1006.1,"summary"=>"Clear","temperature"=>18.63,"time"=>1407063600,"visibility"=>16.09,"windBearing"=>240,"windSpeed"=>14.58},{"apparentTemperature"=>19.54,"cloudCover"=>0.26,"dewPoint"=>10.37,"humidity"=>0.55,"icon"=>"partly-cloudy-day","ozone"=>350.23,"precipIntensity"=>0,"precipProbability"=>0,"pressure"=>1006.27,"summary"=>"Partly Cloudy","temperature"=>19.54,"time"=>1407067200,"visibility"=>16.09,"windBearing"=>240,"windSpeed"=>14.73},{"apparentTemperature"=>20.24,"cloudCover"=>0.26,"dewPoint"=>10.42,"humidity"=>0.53,"icon"=>"partly-cloudy-day","ozone"=>349.33,"precipIntensity"=>0,"precipProbability"=>0,"pressure"=>1006.5,"summary"=>"Partly Cloudy","temperature"=>20.24,"time"=>1407070800,"visibility"=>16.09,"windBearing"=>241,"windSpeed"=>14.31},{"apparentTemperature"=>20.78,"cloudCover"=>0.26,"dewPoint"=>10.39,"humidity"=>0.51,"icon"=>"partly-cloudy-day","ozone"=>348.54,"precipIntensity"=>0,"precipProbability"=>0,"pressure"=>1006.75,"summary"=>"Partly Cloudy","temperature"=>20.78,"time"=>1407074400,"visibility"=>16.09,"windBearing"=>243,"windSpeed"=>13.68},{"apparentTemperature"=>21.08,"cloudCover"=>0.26,"dewPoint"=>10.2,"humidity"=>0.5,"icon"=>"partly-cloudy-day","ozone"=>347.7,"precipIntensity"=>0,"precipProbability"=>0,"pressure"=>1007.05,"summary"=>"Partly Cloudy","temperature"=>21.08,"time"=>1407078000,"visibility"=>16.09,"windBearing"=>244,"windSpeed"=>12.87},{"apparentTemperature"=>21.11,"cloudCover"=>0.18,"dewPoint"=>10.62,"humidity"=>0.51,"icon"=>"clear-day","ozone"=>346.65,"precipIntensity"=>0,"precipProbability"=>0,"pressure"=>1007.39,"summary"=>"Clear","temperature"=>21.11,"time"=>1407081600,"visibility"=>16.09,"windBearing"=>250,"windSpeed"=>12},{"apparentTemperature"=>20.86,"cloudCover"=>0.09,"dewPoint"=>10.88,"humidity"=>0.53,"icon"=>"clear-day","ozone"=>345.54,"precipIntensity"=>0,"precipProbability"=>0,"pressure"=>1007.79,"summary"=>"Clear","temperature"=>20.86,"time"=>1407085200,"visibility"=>16.09,"windBearing"=>257,"windSpeed"=>11.24},{"apparentTemperature"=>20.28,"cloudCover"=>0,"dewPoint"=>10.91,"humidity"=>0.55,"icon"=>"clear-day","ozone"=>344.7,"precipIntensity"=>0,"precipProbability"=>0,"pressure"=>1008.27,"summary"=>"Clear","temperature"=>20.28,"time"=>1407088800,"visibility"=>16.09,"windBearing"=>263,"windSpeed"=>10.66},{"apparentTemperature"=>19.13,"cloudCover"=>0,"dewPoint"=>11.38,"humidity"=>0.61,"icon"=>"clear-day","ozone"=>344.27,"precipIntensity"=>0,"precipProbability"=>0,"pressure"=>1008.92,"summary"=>"Clear","temperature"=>19.13,"time"=>1407092400,"visibility"=>16.09,"windBearing"=>264,"windSpeed"=>9.52},{"apparentTemperature"=>17.56,"cloudCover"=>0,"dewPoint"=>11.4,"humidity"=>0.67,"icon"=>"clear-night","ozone"=>344.1,"precipIntensity"=>0,"precipProbability"=>0,"pressure"=>1009.65,"summary"=>"Clear","temperature"=>17.56,"time"=>1407096000,"visibility"=>16.09,"windBearing"=>265,"windSpeed"=>8.32},{"apparentTemperature"=>16.06,"cloudCover"=>0,"dewPoint"=>11.31,"humidity"=>0.73,"icon"=>"clear-night","ozone"=>343.99,"precipIntensity"=>0,"precipProbability"=>0,"pressure"=>1010.29,"summary"=>"Clear","temperature"=>16.06,"time"=>1407099600,"visibility"=>16.09,"windBearing"=>265,"windSpeed"=>7.11},{"apparentTemperature"=>14.89,"cloudCover"=>0.09,"dewPoint"=>11.09,"humidity"=>0.78,"icon"=>"clear-night","ozone"=>343.82,"precipIntensity"=>0,"precipProbability"=>0,"pressure"=>1010.76,"summary"=>"Clear","temperature"=>14.89,"time"=>1407103200,"visibility"=>16.09,"windBearing"=>261,"windSpeed"=>6.2}],"icon"=>"rain","summary"=>"Light rain later tonight and tomorrow morning."},"latitude"=>52.8757714,"longitude"=>-1.5050589,"minutely"=>{"data"=>[{"precipIntensity"=>0.0838,"precipIntensityError"=>0.0279,"precipProbability"=>0.28,"precipType"=>"rain","time"=>1406932800},{"precipIntensity"=>0.0838,"precipIntensityError"=>0.0305,"precipProbability"=>0.27,"precipType"=>"rain","time"=>1406932860},{"precipIntensity"=>0.0813,"precipIntensityError"=>0.0279,"precipProbability"=>0.23,"precipType"=>"rain","time"=>1406932920},{"precipIntensity"=>0.0813,"precipIntensityError"=>0.0305,"precipProbability"=>0.23,"precipType"=>"rain","time"=>1406932980},{"precipIntensity"=>0.0813,"precipIntensityError"=>0.0305,"precipProbability"=>0.21,"precipType"=>"rain","time"=>1406933040},{"precipIntensity"=>0.0838,"precipIntensityError"=>0.0305,"precipProbability"=>0.22,"precipType"=>"rain","time"=>1406933100},{"precipIntensity"=>0.0889,"precipIntensityError"=>0.0356,"precipProbability"=>0.26,"precipType"=>"rain","time"=>1406933160},{"precipIntensity"=>0.0914,"precipIntensityError"=>0.0356,"precipProbability"=>0.27,"precipType"=>"rain","time"=>1406933220},{"precipIntensity"=>0.0965,"precipIntensityError"=>0.0432,"precipProbability"=>0.27,"precipType"=>"rain","time"=>1406933280},{"precipIntensity"=>0.0991,"precipIntensityError"=>0.0432,"precipProbability"=>0.28,"precipType"=>"rain","time"=>1406933340},{"precipIntensity"=>0.1067,"precipIntensityError"=>0.0483,"precipProbability"=>0.29,"precipType"=>"rain","time"=>1406933400},{"precipIntensity"=>0.1118,"precipIntensityError"=>0.0508,"precipProbability"=>0.31,"precipType"=>"rain","time"=>1406933460},{"precipIntensity"=>0.1219,"precipIntensityError"=>0.0559,"precipProbability"=>0.34,"precipType"=>"rain","time"=>1406933520},{"precipIntensity"=>0.1245,"precipIntensityError"=>0.0584,"precipProbability"=>0.35,"precipType"=>"rain","time"=>1406933580},{"precipIntensity"=>0.1372,"precipIntensityError"=>0.0635,"precipProbability"=>0.39,"precipType"=>"rain","time"=>1406933640},{"precipIntensity"=>0.1422,"precipIntensityError"=>0.0635,"precipProbability"=>0.41,"precipType"=>"rain","time"=>1406933700},{"precipIntensity"=>0.1499,"precipIntensityError"=>0.0635,"precipProbability"=>0.47,"precipType"=>"rain","time"=>1406933760},{"precipIntensity"=>0.1524,"precipIntensityError"=>0.066,"precipProbability"=>0.48,"precipType"=>"rain","time"=>1406933820},{"precipIntensity"=>0.1676,"precipIntensityError"=>0.0686,"precipProbability"=>0.55,"precipType"=>"rain","time"=>1406933880},{"precipIntensity"=>0.1702,"precipIntensityError"=>0.0686,"precipProbability"=>0.56,"precipType"=>"rain","time"=>1406933940},{"precipIntensity"=>0.1854,"precipIntensityError"=>0.0737,"precipProbability"=>0.62,"precipType"=>"rain","time"=>1406934000},{"precipIntensity"=>0.1905,"precipIntensityError"=>0.0737,"precipProbability"=>0.64,"precipType"=>"rain","time"=>1406934060},{"precipIntensity"=>0.2057,"precipIntensityError"=>0.0787,"precipProbability"=>0.72,"precipType"=>"rain","time"=>1406934120},{"precipIntensity"=>0.2108,"precipIntensityError"=>0.0787,"precipProbability"=>0.73,"precipType"=>"rain","time"=>1406934180},{"precipIntensity"=>0.2261,"precipIntensityError"=>0.0813,"precipProbability"=>0.81,"precipType"=>"rain","time"=>1406934240},{"precipIntensity"=>0.2311,"precipIntensityError"=>0.0838,"precipProbability"=>0.83,"precipType"=>"rain","time"=>1406934300},{"precipIntensity"=>0.2286,"precipIntensityError"=>0.0813,"precipProbability"=>0.85,"precipType"=>"rain","time"=>1406934360},{"precipIntensity"=>0.2311,"precipIntensityError"=>0.0787,"precipProbability"=>0.86,"precipType"=>"rain","time"=>1406934420},{"precipIntensity"=>0.2438,"precipIntensityError"=>0.0813,"precipProbability"=>0.88,"precipType"=>"rain","time"=>1406934480},{"precipIntensity"=>0.2489,"precipIntensityError"=>0.0813,"precipProbability"=>0.88,"precipType"=>"rain","time"=>1406934540},{"precipIntensity"=>0.2616,"precipIntensityError"=>0.0838,"precipProbability"=>0.9,"precipType"=>"rain","time"=>1406934600},{"precipIntensity"=>0.2642,"precipIntensityError"=>0.0838,"precipProbability"=>0.89,"precipType"=>"rain","time"=>1406934660},{"precipIntensity"=>0.2769,"precipIntensityError"=>0.0864,"precipProbability"=>0.91,"precipType"=>"rain","time"=>1406934720},{"precipIntensity"=>0.2794,"precipIntensityError"=>0.0864,"precipProbability"=>0.91,"precipType"=>"rain","time"=>1406934780},{"precipIntensity"=>0.2896,"precipIntensityError"=>0.0889,"precipProbability"=>0.92,"precipType"=>"rain","time"=>1406934840},{"precipIntensity"=>0.2921,"precipIntensityError"=>0.0914,"precipProbability"=>0.92,"precipType"=>"rain","time"=>1406934900},{"precipIntensity"=>0.2819,"precipIntensityError"=>0.0864,"precipProbability"=>0.93,"precipType"=>"rain","time"=>1406934960},{"precipIntensity"=>0.2819,"precipIntensityError"=>0.0864,"precipProbability"=>0.93,"precipType"=>"rain","time"=>1406935020},{"precipIntensity"=>0.2896,"precipIntensityError"=>0.0889,"precipProbability"=>0.94,"precipType"=>"rain","time"=>1406935080},{"precipIntensity"=>0.287,"precipIntensityError"=>0.0864,"precipProbability"=>0.94,"precipType"=>"rain","time"=>1406935140},{"precipIntensity"=>0.2946,"precipIntensityError"=>0.0889,"precipProbability"=>0.95,"precipType"=>"rain","time"=>1406935200},{"precipIntensity"=>0.2921,"precipIntensityError"=>0.0889,"precipProbability"=>0.94,"precipType"=>"rain","time"=>1406935260,},{"precipIntensity"=>0.2972,"precipIntensityError"=>0.0914,"precipProbability"=>0.95,"precipType"=>"rain","time"=>1406935320},{"precipIntensity"=>0.2972,"precipIntensityError"=>0.0914,"precipProbability"=>0.95,"precipType"=>"rain","time"=>1406935380},{"precipIntensity"=>0.2997,"precipIntensityError"=>0.094,"precipProbability"=>0.96,"precipType"=>"rain","time"=>1406935440},{"precipIntensity"=>0.2997,"precipIntensityError"=>0.094,"precipProbability"=>0.96,"precipType"=>"rain","time"=>1406935500},{"precipIntensity"=>0.2896,"precipIntensityError"=>0.0914,"precipProbability"=>0.96,"precipType"=>"rain","time"=>1406935560},{"precipIntensity"=>0.287,"precipIntensityError"=>0.0889,"precipProbability"=>0.96,"precipType"=>"rain","time"=>1406935620},{"precipIntensity"=>0.287,"precipIntensityError"=>0.0914,"precipProbability"=>0.96,"precipType"=>"rain","time"=>1406935680},{"precipIntensity"=>0.2845,"precipIntensityError"=>0.0889,"precipProbability"=>0.96,"precipType"=>"rain","time"=>1406935740},{"precipIntensity"=>0.2845,"precipIntensityError"=>0.0914,"precipProbability"=>0.97,"precipType"=>"rain","time"=>1406935800},{"precipIntensity"=>0.2819,"precipIntensityError"=>0.0914,"precipProbability"=>0.97,"precipType"=>"rain","time"=>1406935860},{"precipIntensity"=>0.2819,"precipIntensityError"=>0.0914,"precipProbability"=>0.97,"precipType"=>"rain","time"=>1406935920},{"precipIntensity"=>0.2819,"precipIntensityError"=>0.0914,"precipProbability"=>0.97,"precipType"=>"rain","time"=>1406935980},{"precipIntensity"=>0.2794,"precipIntensityError"=>0.094,"precipProbability"=>0.97,"precipType"=>"rain","time"=>1406936040},{"precipIntensity"=>0.2794,"precipIntensityError"=>0.094,"precipProbability"=>0.97,"precipType"=>"rain","time"=>1406936100},{"precipIntensity"=>0.2718,"precipIntensityError"=>0.0889,"precipProbability"=>0.97,"precipType"=>"rain","time"=>1406936160},{"precipIntensity"=>0.2692,"precipIntensityError"=>0.0889,"precipProbability"=>0.97,"precipType"=>"rain","time"=>1406936220},{"precipIntensity"=>0.2667,"precipIntensityError"=>0.0889,"precipProbability"=>0.97,"precipType"=>"rain","time"=>1406936280},{"precipIntensity"=>0.2642,"precipIntensityError"=>0.0864,"precipProbability"=>0.97,"precipType"=>"rain","time"=>1406936340},{"precipIntensity"=>0.2642,"precipIntensityError"=>0.0889,"precipProbability"=>0.97,"precipType"=>"rain","time"=>1406936400}],"icon"=>"rain","summary"=>"Light rain starting in 14 min."},"offset"=>1,"timezone"=>"Europe/London"}
FORECAST = Hashie::Mash.new(sample_api_response)

# Requires supporting ruby files with custom matchers and macros, etc, in
# spec/support/ and its subdirectories. Files matching `spec/**/*_spec.rb` are
# run as spec files by default. This means that files in spec/support that end
# in _spec.rb will both be required and run as specs, causing the specs to be
# run twice. It is recommended that you do not name files matching this glob to
# end with _spec.rb. You can configure this pattern with the --pattern
# option on the command line or in ~/.rspec, .rspec or `.rspec-local`.
Dir[Rails.root.join("spec/support/**/*.rb")].each { |f| require f }

# Checks for pending migrations before tests are run.
# If you are not using ActiveRecord, you can remove this line.
ActiveRecord::Migration.maintain_test_schema!

RSpec.configure do |config|
  # Remove this line if you're not using ActiveRecord or ActiveRecord fixtures
  config.fixture_path = "#{::Rails.root}/spec/fixtures"

  # If you're not using ActiveRecord, or you'd prefer not to run each of your
  # examples within a transaction, remove the following line or assign false
  # instead of true.
  config.use_transactional_fixtures = true
  config.include FactoryGirl::Syntax::Methods
  config.include Capybara::DSL
  include Warden::Test::Helpers
  Warden.test_mode!

  config.before(:each) do
    stub_request(:get, "https://api.forecast.io/forecast/dbc88215754b7c7e42505af85dfef469/52.875771,-1.505059?units=uk").
         with(:headers => {'Accept'=>'*/*', 'Accept-Encoding'=>'gzip;q=1.0,deflate;q=0.6,identity;q=0.3', 'User-Agent'=>'Faraday v0.9.0'}).
         to_return(:status => 200, :body => FORECAST.to_json, :headers => {})
  end

  # RSpec Rails can automatically mix in different behaviours to your tests
  # based on their file location, for example enabling you to call `get` and
  # `post` in specs under `spec/controllers`.
  #
  # You can disable this behaviour by removing the line below, and instead
  # explicitly tag your specs with their type, e.g.:
  #
  #     RSpec.describe UsersController, :type => :controller do
  #       # ...
  #     end
  #
  # The different available types are documented in the features, such as in
  # https://relishapp.com/rspec/rspec-rails/docs
  config.infer_spec_type_from_file_location!
end
